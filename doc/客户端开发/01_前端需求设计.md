# 前端需求设计（补充：v2 对接指引）

> v2 已发布，前端接入指南见：`doc-v2/26-前端接入指南（v2）.md`。
> 关键变更：统一鉴权（链签名/可选token）、限流与幂等、错误码与路由命名空间（/api/v2）。

## 📋 文档信息

**文档名称**: 前端需求设计文档  
**项目名称**: 基于比特承诺模型的去中心化投票系统  
**文档版本**: 1.0  
**创建时间**: 2025年8月  
**文档状态**: 需求分析完成  

## 🎯 项目概述

### 项目背景
基于比特承诺模型的去中心化投票系统需要一个现代化的Web前端界面，为用户提供直观、易用的投票体验。前端将作为用户与区块链系统交互的主要入口，支持投票创建、参与、结果查看等核心功能。

### 项目目标
- 提供直观易用的投票系统用户界面
- 支持完整的投票生命周期管理
- 集成区块链钱包连接和交易签名
- 确保用户隐私和数据安全
- 提供响应式设计，支持多种设备

## 👥 用户角色分析

### 1. 治理代币持有者 (Governance Token Holder)
**特征描述**:
- 持有$LUCKEE治理代币的用户
- 具备区块链操作基础
- 参与系统治理和决策

**主要需求**:
- 查看代币余额和权限等级
- 参与治理提案投票
- 创建和管理NFT类型
- 监控系统运行状态

### 2. NFT创建者 (NFT Creator)
**特征描述**:
- 达到Creator权限等级的用户（持有≥1000代币）
- 具备NFT类型设计能力
- 关注投票类型的创新和实用性

**主要需求**:
- 创建新的NFT类型
- 定义投票类型Schema
- 配置投票参数和规则
- 管理创建的NFT类型

### 3. 高级治理者 (Advanced Governor)
**特征描述**:
- 达到Admin权限等级的用户（持有≥100,000代币）
- 具备高级治理权限
- 参与系统参数调整和升级决策

**主要需求**:
- 参与系统参数治理
- 创建高级投票类型
- 参与紧急情况处理
- 系统升级投票

### 4. 投票参与者 (Voting Participant)
**特征描述**:
- 持有相应NFT类型的用户
- 需要简单易用的投票界面
- 关注投票结果和个人隐私

**主要需求**:
- 查看可参与的投票
- 提交投票承诺
- 揭示投票内容
- 查看投票结果

### 5. 观察者 (Observer)
**特征描述**:
- 不参与投票，但关注投票过程
- 需要透明的信息展示
- 可能包括审计人员和普通用户

**主要需求**:
- 查看投票列表
- 查看投票详情
- 查看投票结果
- 验证投票证明

## 🔍 功能需求分析

### 1. 用户认证与授权

#### 1.1 钱包连接
**功能描述**: 支持多种区块链钱包连接
**详细需求**:
- 支持Injective钱包连接
- 支持Keplr钱包连接
- 支持Metamask钱包连接（兼容性）
- 钱包连接状态管理
- 连接失败处理和重试机制

#### 1.2 身份验证
**功能描述**: 基于代币持有量的权限验证
**详细需求**:
- 代币余额查询和显示
- 权限等级自动判断
- 权限不足时的友好提示
- 权限升级路径指导

#### 1.3 会话管理
**功能描述**: 用户登录状态和权限管理
**详细需求**:
- 登录状态持久化
- 权限信息缓存
- 自动权限刷新
- 安全退出机制

### 2. 投票会话管理

#### 2.1 投票创建
**功能描述**: 创建新的投票会话
**详细需求**:
- 投票基本信息配置（标题、描述、选项）
- 投票时间设置（承诺期、揭示期）
- 参与者权限配置
- 投票类型选择（单目标、多目标、多等级）
- 高级参数配置（算法参数、奖励设置）

#### 2.2 投票列表
**功能描述**: 显示所有可参与的投票
**详细需求**:
- 投票状态分类显示
- 搜索和筛选功能
- 分页加载支持
- 实时状态更新
- 个人参与状态标识

#### 2.3 投票详情
**功能描述**: 显示投票的详细信息
**详细需求**:
- 投票基本信息展示
- 参与者列表和状态
- 投票进度可视化
- 实时结果更新
- 相关操作按钮

### 3. 投票参与流程

#### 3.1 承诺阶段
**功能描述**: 用户提交投票承诺
**详细需求**:
- 投票选项选择界面
- 承诺生成和提交
- 提交状态反馈
- 承诺确认和修改
- 批量承诺支持

#### 3.2 揭示阶段
**功能描述**: 用户揭示投票内容
**详细需求**:
- 已提交承诺列表
- 揭示操作界面
- 随机数输入和验证
- 揭示状态跟踪
- 批量揭示支持

#### 3.3 结果查看
**功能描述**: 查看投票结果和证明
**详细需求**:
- 投票结果展示
- 中奖者列表显示
- 结果证明验证
- 结果导出功能
- 历史结果查询

### 4. NFT管理

#### 4.1 NFT查看
**功能描述**: 查看用户拥有的NFT
**详细需求**:
- NFT列表展示
- NFT详情查看
- 元数据展示
- 持有时间统计
- 转移历史记录

#### 4.2 NFT操作
**功能描述**: 执行NFT相关操作
**详细需求**:
- NFT转移操作
- 批量操作支持
- 操作确认界面
- 操作状态跟踪
- 操作历史记录

### 5. 代币管理

#### 5.1 余额查看
**功能描述**: 查看代币余额和状态
**详细需求**:
- 代币余额显示
- 质押状态查看
- 锁定状态查看
- 奖励累计显示
- 历史记录查询

#### 5.2 代币操作
**功能描述**: 执行代币相关操作
**详细需求**:
- 代币转移操作
- 质押和解除质押
- 锁定和解锁
- 奖励领取
- 批量操作支持

### 6. 治理代币管理

#### 6.1 代币持有管理
**功能描述**: 治理代币持有和权限管理
**详细需求**:
- 代币余额查看
- 权限等级自动计算
- 治理提案参与
- 投票权重计算
- 委托和继承管理

#### 6.2 治理参与
**功能描述**: 参与系统治理决策
**详细需求**:
- 治理提案查看
- 提案投票参与
- 治理历史记录
- 治理参数调整
- 紧急提案处理

### 7. NFT类型管理

#### 7.1 NFT类型创建
**功能描述**: 创建新的投票类型
**详细需求**:
- 类型基本信息定义
- Schema设计和验证
- 权限要求配置
- 版本管理
- 类型发布

#### 7.2 NFT类型管理
**功能描述**: 管理已创建的NFT类型
**详细需求**:
- 类型列表查看
- 类型详情编辑
- 版本更新管理
- 类型状态管理
- 使用统计查看

## 🎨 非功能需求

### 1. 性能需求
- **页面加载时间**: 首屏加载 < 3秒
- **操作响应时间**: 用户操作响应 < 1秒
- **并发支持**: 支持1000+并发用户
- **数据更新**: 实时数据更新延迟 < 2秒

### 2. 可用性需求
- **系统可用性**: 99.9%
- **错误恢复**: 自动错误恢复时间 < 30秒
- **用户引导**: 新用户操作引导完整
- **帮助系统**: 上下文相关的帮助信息

### 3. 安全需求
- **数据加密**: 敏感数据传输加密
- **身份验证**: 多重身份验证支持
- **权限控制**: 细粒度权限控制
- **审计日志**: 完整的操作审计日志

### 4. 兼容性需求
- **浏览器支持**: Chrome 90+, Firefox 88+, Safari 14+
- **设备支持**: 桌面端优先，移动端预留接口
- **分辨率支持**: 1920x1080及以上分辨率
- **网络环境**: 支持低带宽环境

## 📱 移动端预留接口

### 1. 响应式设计
- 使用CSS Grid和Flexbox布局
- 支持触摸操作和手势
- 适配不同屏幕尺寸
- 移动端友好的交互设计

### 2. 接口预留
- 触摸事件处理接口
- 移动端导航组件
- 移动端表单组件
- 移动端图表组件

### 3. 性能优化
- 图片懒加载和压缩
- 代码分割和按需加载
- 移动端缓存策略
- 网络请求优化

## 🔧 技术约束

### 1. 前端技术栈
- **框架**: React 18 + TypeScript
- **状态管理**: Redux Toolkit
- **UI组件库**: Material-UI v5
- **构建工具**: Vite
- **包管理**: npm/yarn

### 2. 区块链集成
- **钱包连接**: @injectivelabs/sdk-ts
- **交易签名**: 钱包原生签名
- **状态查询**: REST API + WebSocket
- **事件监听**: WebSocket实时更新

### 3. 后端接口
- **API协议**: RESTful API
- **数据格式**: JSON
- **认证方式**: JWT + 钱包签名
- **实时通信**: WebSocket

## 📊 需求优先级

### 高优先级 (P0)
- 用户钱包连接
- 投票创建和参与
- 基本投票结果查看
- 用户认证和权限验证

### 中优先级 (P1)
- NFT类型创建和管理
- 治理代币管理
- 治理提案参与
- 高级投票配置

### 低优先级 (P2)
- 高级数据可视化
- 批量操作支持
- 个性化设置
- 移动端优化

## 📝 验收标准

### 功能验收
- 所有核心功能正常工作
- 用户操作流程完整
- 错误处理机制完善
- 权限控制正确

### 性能验收
- 页面加载时间达标
- 操作响应时间达标
- 并发用户数达标
- 数据更新延迟达标

### 用户体验验收
- 界面设计美观易用
- 操作流程直观清晰
- 错误提示友好明确
- 帮助信息完整准确

### 兼容性验收
- 主流浏览器正常显示
- 不同分辨率适配良好
- 触摸设备操作正常
- 网络环境适应良好

---

**文档编制日期**：2025年8月  
**文档编制人**：luckeeDAO技术评估团队  
**文档审核人**：luckeeDAO管理委员会  

**最后更新**：2025-08  
**维护人**：文档与架构联合组
